!function(){"use strict";function e(e,t){e.setPrefix("smoothieApp"),t.setOptions({colours:["#FDB45C","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"],responsive:!0,maintainAspectRatio:!1})}function t(e,t,n,r){function o(e){var t,n;"bed"==e?(t=30,n=32):(t=200,n=210);var r=Math.random()*(n-t+1)+t;return r.toFixed(1)}e.setCurrentLanguage(t.get("currentLanguage")||"en"),e.debug=!0,n.theme="bs3",n.activate="select";var i=0,a=0,c=0,s=30,u=25,l=22;r.whenPOST("/command").respond(function(e,t,n){var r="ok";n=n.replace(/(\r\n|\n|\r)/gm,"");var d;if("M105"==n)s=o("T0"),u=o("T1"),l=o("bed"),r="ok T:"+s+" /"+i+"@0 ",r+="T1:"+u+" /"+a+"@0 ",r+="B:"+l+" /"+c+"@0 ",r+="P:29.7 /0.0 @0\n";else if("M20"==n)d=Math.floor(2*Math.random()*10+1),r="Begin file list\nconfig.txt\nweb\nweb2\ntest"+(d+2)+".gcode\ntest"+(d-2)+".gcode\ntest"+(d+3)+".gcode\nEnd file list\nok";else if(n.indexOf("M104")>-1||n.indexOf("M140")>-1){var f,h;n.indexOf("M104")>-1?n.indexOf("T1")&&(f=/M104 S(.*) T(.*)/gi,h=f.exec(n),"0"==h[2]?i=Number(h[1]).toFixed(1):a=Number(h[1]).toFixed(1)):(f=/M140 S(.*)/gi,h=f.exec(n),c=Number(h[1]).toFixed(1))}else"progress"==n?r="Nothing is printed":"abort"==n&&(r="Abort! Abort!");return[200,r,{}]}),r.whenGET(/^img\//).passThrough()}angular.module("smoothieApp",["ui.bootstrap","gettext","ngSanitize","luegg.directives","xeditable","LocalStorageModule","ngFileUpload","chart.js","ngMockE2E"]).config(e).run(t),t.$inject=["gettextCatalog","localStorageService","editableOptions","$httpBackend"],e.$inject=["localStorageServiceProvider","ChartJsProvider"]}(),angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("de",{"Language:":"Sprache:"}),e.setStrings("pl",{Abort:"Przerwij","auto-check every:":"sprawdzaj co:",Autoscroll:"Autoscroll",Bed:"Stół",Clear:"Wyczyść",Commands:"Komendy",Controls:"Sterowanie",Delete:"Usuń","enable second extruder":"włącz drugi ekstruder",Extrude:"Wytłaczaj","Extruder T0":"Ekstruder T0","Extruder T1":"Ekstruder T1",Extruders:"Ekstrudery",Files:"Pliki","Filter temperatures":"Filtruj temperatury","Get temperature":"Sprawdź temperatury","Heater T0":"Głowica T0","Heater T1":"Głowica T1","Language:":"Język:","Motors off":"Wyłącz",Name:"Nazwa",Options:"Opcje",Print:"Drukuj",Progress:"Postęp",Refresh:"Odśwież",Reverse:"Cofnij",sec:"sek",Send:"Wyślij","Send Command...":"Wyślij polecenie",Settings:"Ustawienia","Speed:":"Prędkość:",Temperatures:"Temperatury",Upload:"Wczytaj","Value | Target":"Pomiar | Cel"})}]),function(){"use strict";function e(e,t){function n(){t.registerOutput(u)}function r(){u.command&&(console.log("Command: "+u.command),t.runCommand(u.command).then(function(e){u.updateOutput(e),u.cmdHistory.push(u.command),u.cmdHistory.slice(-300),u.cmdHistoryIdx=u.cmdHistory.length,u.command=""}))}function o(e){var t=e.keyCode;return 38==t||40==t?(38==t&&u.cmdHistory.length>0&&u.cmdHistoryIdx>0?u.cmdHistoryIdx--:40==t&&u.cmdHistoryIdx<u.cmdHistory.length-1&&u.cmdHistoryIdx++,u.cmdHistoryIdx>=0&&u.cmdHistoryIdx<u.cmdHistory.length&&(u.command=u.cmdHistory[u.cmdHistoryIdx]),!1):!0}function i(e){return 13==e.keyCode&&u.sendCommand(),!0}function a(){u.log=[],u.updateOutput()}function c(){u.updateOutput()}function s(e){u.log||(u.log=[]),e&&(u.log=u.log.concat(e),u.log=u.log.slice(-300));for(var t=/ok T:/g,n="",r=u.log.length,o=0;r>o;o++)u.filterOutput&&u.log[o].match(t)||(n+=u.log[o]);u.commandOutput=n}var u=this;u.log=[],u.command="",u.commandOutput="",u.cmdHistory=[],u.cmdHistoryIdx=-1,u.autoscrollEnabled=!0,u.filterOutput=!1,u.sendCommand=r,u.handleKeyDown=o,u.handleKeyUp=i,u.clear=a,u.onFilterChange=c,u.updateOutput=s,n()}angular.module("smoothieApp").controller("CommandCtrl",e),e.$inject=["$scope","DataService"]}(),function(){"use strict";function e(e){function t(){e.updateSecondExtruder()}function n(t,n){console.log("Extruder: "+t+" | length: "+r.filamenLength+" | speed: "+r.velocity),e.runCommand(t).then(function(e){console.log("Extruder result: "+e)}),e.runCommand("G91 G0 E"+r.filamenLength*n+" F"+r.velocity+" G90").then(function(e){console.log("Command result: "+e)})}var r=this;r.secondExtruder=e.secondExtruderState(),r.filamenLength=5,r.velocity=100,r.onSecondExtruderSupportChange=t,r.extrude=n}angular.module("smoothieApp").controller("ExtruderCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t){function n(){r()}function r(){console.log("RefreshFiles"),e.runCommand("M20").then(function(e){o(e)},function(e){console.error(e.statusText)})}function o(e){l.fileList=[];var t=e.split("\n");angular.forEach(t,function(e,t){if(e=e.trim(),e.match(/\.g(code)?$/)){var n={filename:e,uploading:!1,percentage:0};l.fileList.push(n)}})}function i(t){console.log("print file - "+t),e.runCommand("play /sd/"+t).then(function(e){console.log("Result: "+e)})}function a(){e.runCommand("progress").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function c(){e.runCommand("abort").then(function(t){e.broadcastCommand(t)},function(e){console.error(e.statusText)})}function s(n){n&&(e.broadcastCommand("Uploading: "+n.name+"\n"),l.currentUploadedFile={filename:n.name,uploading:!0,percentage:0},l.fileList.push(l.currentUploadedFile),t.http({url:"/upload",headers:{"X-Filename":n.name},data:n}).then(function(t){e.broadcastCommand("Upload successful. Response: "+t.data),l.currentUploadedFile.uploading=!1,l.refreshFiles()},function(t){e.broadcastCommand("Error status: "+t.status+"\n")},function(e){var t=parseInt(100*e.loaded/e.total);l.currentUploadedFile.percentage=t,console.log("Progress: "+t+"%")}))}function u(t){e.runCommand("M30 "+t.filename).then(function(n){e.broadcastCommand("Deleted file: "+t.filename+"\n"),l.refreshFiles()},function(e){console.error(e.statusText)})}var l=this;l.fileList=[],l.currentUploadedFile={},l.refreshFiles=r,l.print=i,l.progress=a,l.abort=c,l.uploadFile=s,l.deleteFile=u,n()}angular.module("smoothieApp").controller("FileCtrl",e),e.$inject=["DataService","Upload"]}(),function(){"use strict";function e(e,t){function n(n){o.languages.current=n,e.setCurrentLanguage(n),t.set("currentLanguage",o.languages.current)}function r(){t.set("printerName",o.printerName)}var o=this;o.printerName=t.get("printerName")||"Your printer name",o.languages={current:e.currentLanguage,available:{en:"English",pl:"Polski"}},o.setLanguage=n,o.updatePrinterName=r}angular.module("smoothieApp").controller("HeaderCtrl",e),e.$inject=["gettextCatalog","localStorageService"]}(),function(){"use strict";function e(e){function t(e){console.log("Home axis: "+e)}function n(){console.log("MotorsOff"),e.runCommand("M18").then(function(e){console.log("Motors turned off! - Result: "+e)},function(e){console.error(e.statusText)})}function r(t){console.log("jogButtonClick - "+t),e.runCommand(t).then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function o(t){console.log("jogXYClick - "+t),e.runCommand("G91 G0 "+t+" F"+a.xy_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}function i(t){console.log("jogZClick - "+t),e.runCommand("G91 G0 "+t+" F"+a.z_velocity+" G90").then(function(e){console.log("Result: "+e)},function(e){console.error(e.statusText)})}var a=this;a.elementId="",a.xy_velocity=3e3,a.z_velocity=200,a.homeAxis=t,a.motorsOff=n,a.jogButtonClick=r,a.jogXYClick=o,a.jogZClick=i}angular.module("smoothieApp").controller("MotorCtrl",e),e.$inject=["DataService"]}(),function(){"use strict";function e(e,t,n){function r(){d.autoCheckEnabled&&(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),d.getTemperatures())}function o(){d.getTemperatures()}function i(e){switch(console.log("HeatOff - heater: "+e),e){case"T0":d.heaterT0SelectedTemp=0;break;case"T1":d.heaterT1SelectedTemp=0;break;case"bed":d.bedSelectedTemp=0}var n="bed"!=e,r=n?104:140,o="M"+r+" S0";n&&(o+=" "+e),t.runCommand(o).then(function(e){d.getTemperatures()})}function a(e){console.log("HeatSet - heater: "+e);var n=0;switch(e){case"T0":n=d.heaterT0SelectedTemp;break;case"T1":n=d.heaterT1SelectedTemp;break;case"bed":n=d.bedSelectedTemp}console.log("Temp: "+n);var r="bed"!=e,o=r?104:140,i="M"+o+" S"+n;r&&(i+=" "+e),t.runCommand(i).then(function(e){d.getTemperatures()})}function c(e,t){return 13==e.keyCode&&d.heatSet(t),!0}function s(){d.autoCheckEnabled?(d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval),n.set("autoCheckEnabled","true"),d.getTemperatures()):(angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),n.set("autoCheckEnabled","false"))}function u(){n.set("tempInterval",d.tempInterval),angular.isDefined(d.localTempInterval)&&e.cancel(d.localTempInterval),d.localTempInterval=e(d.onTimeout,1e3*d.tempInterval)}function l(){t.runCommand("M105").then(function(e){t.broadcastCommand(e);for(var n,r=/(B|T(\d*)):\s*([+]?[0-9]*\.?[0-9]+)? (\/)([+]?[0-9]*\.?[0-9]+)?/gi;null!==(n=r.exec(e));){var o=n[1],i=n[3]+"°C";i+=" | "+n[5]+"°C","T"==o?(d.heaterT0ActualTemp=n[3],d.heaterT0DisplayTemp=i):"T1"==o&&(d.heaterT1ActualTemp=n[3],d.heaterT1DisplayTemp=i),"B"==o&&(d.bedActualTemp=Number(n[3]),d.bedDisplayTemp=i)}for(d.labels.length&&(d.labels=d.labels.slice(1),d.dataHeater[0]=d.dataHeater[0].slice(1),d.dataBed[0]=d.dataBed[0].slice(1));d.labels.length<20;)d.labels.push(""),d.dataHeater[0].push(d.heaterT0ActualTemp),d.dataBed[0].push(d.bedActualTemp)},function(e){console.error(e.statusText)})}var d=this;d.secondExtruder=t.secondExtruderState(),d.labels=[],d.seriesHeater=["Heater T0"],d.dataHeater=[[]],d.heaterColours=["#4D5360"],d.seriesBed=["Bed"],d.dataBed=[[]],d.bedColours=["#F7464A"],d.options={animation:!1,showScale:!0,showTooltips:!1,pointDot:!1,datasetStrokeWidth:.5,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},d.localTempInterval={},d.tempInterval=n.get("tempInterval")||3,d.autoCheckEnabled="true"==n.get("autoCheckEnabled"),d.heaterT0SelectedTemp=0,d.heaterT0ActualTemp="-",d.heaterT0DisplayTemp="",d.heaterT1SelectedTemp=0,d.heaterT1ActualTemp="-",d.heaterT1DisplayTemp="",d.bedSelectedTemp=0,d.bedActualTemp="-",d.bedDisplayTemp="",d.onTimeout=o,d.heatOff=i,d.heatSet=a,d.handleKeyUp=c,d.onAutoCheckChange=s,d.onTempIntervalChange=u,d.getTemperatures=l,r()}angular.module("smoothieApp").controller("TempCtrl",e),e.$inject=["$interval","DataService","localStorageService"]}(),function(){"use strict";function e(e,t){function n(t){return t+="\n",e.post(c,t).then(function(e){return e.data})}function r(e){u.push(e)}function o(e){for(var t=0;t<u.length;++t)u[t].updateOutput(e)}function i(){return s}function a(){t.set("secondExtruderSupportEnabled",s.supportEnabled?"true":"false")}var c="/command",s={supportEnabled:"true"==t.get("secondExtruderSupportEnabled")},u=[],l={runCommand:n,registerOutput:r,broadcastCommand:o,secondExtruderState:i,updateSecondExtruder:a};return l}angular.module("smoothieApp").factory("DataService",e),e.$inject=["$http","localStorageService"]}(),function(e,t){"use strict";function n(e,n,r){function o(e){var t=e;return{getValue:function(){return t},setValue:function(e){t=e}}}function i(e,t){return{getValue:function(){return e(t)},setValue:function(){}}}function a(e,t,n){return{getValue:function(){return e(n)},setValue:function(r){r!==e(n)&&n.$apply(function(){t(n,r)})}}}if(""!==n){var c=e(n);return c.assign!==t?a(c,c.assign,r):i(c,r)}return o(!0)}function r(e,t,r){e.directive(t,["$parse","$window","$timeout",function(e,o,i){return{priority:1,restrict:"A",link:function(a,c,s){function u(){d.getValue()&&!r.isAttached(l)&&r.scroll(l)}var l=c[0],d=n(e,s[t],a);a.$watch(u),i(u,0,!1),o.addEventListener("resize",u,!1),c.bind("scroll",function(){d.setValue(r.isAttached(l))})}}}])}var o={isAttached:function(e){return e.scrollTop+e.clientHeight+1>=e.scrollHeight},scroll:function(e){e.scrollTop=e.scrollHeight}},i={isAttached:function(e){return e.scrollTop<=1},scroll:function(e){e.scrollTop=0}},a={isAttached:function(e){return e.scrollLeft+e.clientWidth+1>=e.scrollWidth},scroll:function(e){e.scrollLeft=e.scrollWidth}},c={isAttached:function(e){return e.scrollLeft<=1},scroll:function(e){e.scrollLeft=0}},s=e.module("luegg.directives",[]);r(s,"scrollGlue",o),r(s,"scrollGlueTop",i),r(s,"scrollGlueBottom",o),r(s,"scrollGlueLeft",c),r(s,"scrollGlueRight",a)}(angular),function(e,t,n){"use strict";function r(e){var t;if(t=e.match(u)){var n=new Date(0),r=0,i=0;return t[9]&&(r=o(t[9]+t[10]),i=o(t[9]+t[11])),n.setUTCFullYear(o(t[1]),o(t[2])-1,o(t[3])),n.setUTCHours(o(t[4]||0)-r,o(t[5]||0)-i,o(t[6]||0),o(t[7]||0)),n}return e}function o(e){return parseInt(e,10)}function i(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function a(e,r,o,i){function a(e,n,r,o){return t.isFunction(e)?e:function(){return t.isNumber(e)?[e,n,r,o]:[200,e,n,r]}}function u(e,a,c,u,l,d,$,v){function T(e){return t.isString(e)||t.isFunction(e)||e instanceof RegExp?e:t.toJson(e)}function E(t){function o(){var n=t.response(e,a,c,l,t.params(a));w.$$respHeaders=n[2],u(m(n[0]),m(n[1]),w.getAllResponseHeaders(),m(n[3]||""))}function s(){for(var e=0,t=g.length;t>e;e++)if(g[e]===o){g.splice(e,1),u(-1,n,"");break}}return!i&&d&&(d.then?d.then(s):r(s,d)),o}var w=new s,C=h[0],y=!1;if(C&&C.match(e,a)){if(!C.matchData(c))throw new Error("Expected "+C+" with different data\nEXPECTED: "+T(C.data)+"\nGOT:      "+c);if(!C.matchHeaders(l))throw new Error("Expected "+C+" with different headers\nEXPECTED: "+T(C.headers)+"\nGOT:      "+T(l));if(h.shift(),C.response)return void g.push(E(C));y=!0}for(var k,b=-1;k=f[++b];)if(k.match(e,a,c,l||{})){if(k.response)(i?i.defer:p)(E(k));else{if(!k.passThrough)throw new Error("No response defined !");o(e,a,c,u,l,d,$,v)}return}throw y?new Error("No response defined !"):new Error("Unexpected request: "+e+" "+a+"\n"+(C?"Expected "+C:"No more request expected"))}function l(e){var n={regexp:e},r=n.keys=[];return e&&t.isString(e)?(e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(e,t,n,o){var i="?"===o?o:null,a="*"===o?o:null;return r.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(a&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),n.regexp=new RegExp("^"+e,"i"),n):n}function d(e){t.forEach(["GET","DELETE","JSONP","HEAD"],function(t){u[e+t]=function(r,o,i){return u[e](t,r,n,o,i)}}),t.forEach(["PUT","POST","PATCH"],function(t){u[e+t]=function(n,r,o,i){return u[e](t,n,r,o,i)}})}var f=[],h=[],g=[],p=t.bind(g,g.push),m=t.copy;return u.when=function(e,t,r,o,s){var u=new c(e,t,r,o,s),l={respond:function(e,t,r,o){return u.passThrough=n,u.response=a(e,t,r,o),l}};return i&&(l.passThrough=function(){return u.response=n,u.passThrough=!0,l}),f.push(u),l},d("when"),u.whenRoute=function(e,t){var r=l(t);return u.when(e,r.regexp,n,n,r.keys)},u.expect=function(e,t,n,r,o){var i=new c(e,t,n,r,o),s={respond:function(e,t,n,r){return i.response=a(e,t,n,r),s}};return h.push(i),s},d("expect"),u.expectRoute=function(e,t){var r=l(t);return u.expect(e,r.regexp,n,n,r.keys)},u.flush=function(n,r){if(r!==!1&&e.$digest(),!g.length)throw new Error("No pending request to flush !");if(t.isDefined(n)&&null!==n)for(;n--;){if(!g.length)throw new Error("No more pending request to flush !");g.shift()()}else for(;g.length;)g.shift()();u.verifyNoOutstandingExpectation(r)},u.verifyNoOutstandingExpectation=function(t){if(t!==!1&&e.$digest(),h.length)throw new Error("Unsatisfied requests: "+h.join(", "))},u.verifyNoOutstandingRequest=function(){if(g.length)throw new Error("Unflushed requests: "+g.length)},u.resetExpectations=function(){h.length=0,g.length=0},u}function c(e,n,r,o,i){this.data=r,this.headers=o,this.match=function(n,r,o,i){return e!=n?!1:this.matchUrl(r)?t.isDefined(o)&&!this.matchData(o)?!1:!t.isDefined(i)||this.matchHeaders(i):!1},this.matchUrl=function(e){return n?t.isFunction(n.test)?n.test(e):t.isFunction(n)?n(e):n==e:!0},this.matchHeaders=function(e){return t.isUndefined(o)?!0:t.isFunction(o)?o(e):t.equals(o,e)},this.matchData=function(e){return t.isUndefined(r)?!0:r&&t.isFunction(r.test)?r.test(e):r&&t.isFunction(r)?r(e):r&&!t.isString(r)?t.equals(t.fromJson(t.toJson(r)),t.fromJson(e)):r==e},this.toString=function(){return e+" "+n},this.params=function(e){function r(){var r={};if(!n||!t.isFunction(n.test)||!i||0===i.length)return r;var o=n.exec(e);if(!o)return r;for(var a=1,c=o.length;c>a;++a){var s=i[a-1],u=o[a];s&&u&&(r[s.name||s]=u)}return r}function o(){var n,r,o={},i=e.indexOf("?")>-1?e.substring(e.indexOf("?")+1):"";return t.forEach(i.split("&"),function(e){if(e&&(n=e.replace(/\+/g,"%20").split("="),r=a(n[0]),t.isDefined(r))){var i=t.isDefined(n[1])?a(n[1]):!0;hasOwnProperty.call(o,r)?t.isArray(o[r])?o[r].push(i):o[r]=[o[r],i]:o[r]=i}}),o}function a(e){try{return decodeURIComponent(e)}catch(t){}}return t.extend(o(),r())}}function s(){s.$$lastInstance=this,this.open=function(e,t,n){this.$$method=e,this.$$url=t,this.$$async=n,this.$$reqHeaders={},this.$$respHeaders={}},this.send=function(e){this.$$data=e},this.setRequestHeader=function(e,t){this.$$reqHeaders[e]=t},this.getResponseHeader=function(e){var r=this.$$respHeaders[e];return r?r:(e=t.lowercase(e),(r=this.$$respHeaders[e])?r:(r=n,t.forEach(this.$$respHeaders,function(n,o){r||t.lowercase(o)!=e||(r=n)}),r))},this.getAllResponseHeaders=function(){var e=[];return t.forEach(this.$$respHeaders,function(t,n){e.push(n+": "+t)}),e.join("\n")},this.abort=t.noop}t.mock={},t.mock.$BrowserProvider=function(){this.$get=function(){return new t.mock.$Browser}},t.mock.$Browser=function(){var e=this;this.isMock=!0,e.$$url="http://server/",e.$$lastUrl=e.$$url,e.pollFns=[],e.$$completeOutstandingRequest=t.noop,e.$$incOutstandingRequestCount=t.noop,e.onUrlChange=function(t){return e.pollFns.push(function(){e.$$lastUrl===e.$$url&&e.$$state===e.$$lastState||(e.$$lastUrl=e.$$url,e.$$lastState=e.$$state,t(e.$$url,e.$$state))}),t},e.$$applicationDestroyed=t.noop,e.$$checkUrlChange=t.noop,e.deferredFns=[],e.deferredNextId=0,e.defer=function(t,n){return n=n||0,e.deferredFns.push({time:e.defer.now+n,fn:t,id:e.deferredNextId}),e.deferredFns.sort(function(e,t){return e.time-t.time}),e.deferredNextId++},e.defer.now=0,e.defer.cancel=function(n){var r;return t.forEach(e.deferredFns,function(e,t){e.id===n&&(r=t)}),t.isDefined(r)?(e.deferredFns.splice(r,1),!0):!1},e.defer.flush=function(n){if(t.isDefined(n))e.defer.now+=n;else{if(!e.deferredFns.length)throw new Error("No deferred tasks to be flushed");e.defer.now=e.deferredFns[e.deferredFns.length-1].time}for(;e.deferredFns.length&&e.deferredFns[0].time<=e.defer.now;)e.deferredFns.shift().fn()},e.$$baseHref="/",e.baseHref=function(){return this.$$baseHref}},t.mock.$Browser.prototype={poll:function(){t.forEach(this.pollFns,function(e){e()})},url:function(e,n,r){return t.isUndefined(r)&&(r=null),e?(this.$$url=e,this.$$state=t.copy(r),this):this.$$url},state:function(){return this.$$state},notifyWhenNoOutstandingRequests:function(e){e()}},t.mock.$ExceptionHandlerProvider=function(){var e;this.mode=function(t){switch(t){case"log":case"rethrow":var n=[];e=function(e){if(1==arguments.length?n.push(e):n.push([].slice.call(arguments,0)),"rethrow"===t)throw e},e.errors=n;break;default:throw new Error("Unknown mode '"+t+"', only 'log'/'rethrow' modes are allowed!")}},this.$get=function(){return e},this.mode("rethrow")},t.mock.$LogProvider=function(){function e(e,t,n){return e.concat(Array.prototype.slice.call(t,n))}var n=!0;this.debugEnabled=function(e){return t.isDefined(e)?(n=e,this):n},this.$get=function(){var r={log:function(){r.log.logs.push(e([],arguments,0))},warn:function(){r.warn.logs.push(e([],arguments,0))},info:function(){r.info.logs.push(e([],arguments,0))},error:function(){r.error.logs.push(e([],arguments,0))},debug:function(){n&&r.debug.logs.push(e([],arguments,0))}};return r.reset=function(){r.log.logs=[],r.info.logs=[],r.warn.logs=[],r.error.logs=[],r.debug.logs=[]},r.assertEmpty=function(){var e=[];if(t.forEach(["error","warn","info","log","debug"],function(n){t.forEach(r[n].logs,function(r){t.forEach(r,function(t){e.push("MOCK $log ("+n+"): "+String(t)+"\n"+(t.stack||""))})})}),e.length)throw e.unshift("Expected $log to be empty! Either a message was logged unexpectedly, or an expected log message was not checked and removed:"),e.push(""),new Error(e.join("\n---------\n"))},r.reset(),r}},t.mock.$IntervalProvider=function(){this.$get=["$browser","$rootScope","$q","$$q",function(e,n,r,o){var i=[],a=0,c=0,s=function(s,u,l,d){function f(){if($.notify(p++),l>0&&p>=l){var r;$.resolve(p),t.forEach(i,function(e,t){e.id===v.$$intervalId&&(r=t)}),t.isDefined(r)&&i.splice(r,1)}m?e.defer.flush():n.$apply()}var h=arguments.length>4,g=h?Array.prototype.slice.call(arguments,4):[],p=0,m=t.isDefined(d)&&!d,$=(m?o:r).defer(),v=$.promise;return l=t.isDefined(l)?l:0,v.then(null,null,h?function(){s.apply(null,g)}:s),v.$$intervalId=a,i.push({nextTime:c+u,delay:u,fn:f,id:a,deferred:$}),i.sort(function(e,t){return e.nextTime-t.nextTime}),a++,v};return s.cancel=function(e){if(!e)return!1;var n;return t.forEach(i,function(t,r){t.id===e.$$intervalId&&(n=r)}),t.isDefined(n)?(i[n].deferred.reject("canceled"),i.splice(n,1),!0):!1},s.flush=function(e){for(c+=e;i.length&&i[0].nextTime<=c;){var t=i[0];t.fn(),t.nextTime+=t.delay,i.sort(function(e,t){return e.nextTime-t.nextTime})}return e},s}]};var u=/^(-?\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?:\:?(\d\d)(?:\:?(\d\d)(?:\.(\d{3}))?)?)?(Z|([+-])(\d\d):?(\d\d)))?$/;t.mock.TzDate=function(e,n){var o=new Date(0);if(t.isString(n)){var a=n;if(o.origDate=r(n),n=o.origDate.getTime(),isNaN(n))throw{name:"Illegal Argument",message:"Arg '"+a+"' passed into TzDate constructor is not a valid date string"}}else o.origDate=new Date(n);var c=new Date(n).getTimezoneOffset();o.offsetDiff=60*c*1e3-1e3*e*60*60,o.date=new Date(n+o.offsetDiff),o.getTime=function(){return o.date.getTime()-o.offsetDiff},o.toLocaleDateString=function(){return o.date.toLocaleDateString()},o.getFullYear=function(){return o.date.getFullYear()},o.getMonth=function(){return o.date.getMonth()},o.getDate=function(){return o.date.getDate()},o.getHours=function(){return o.date.getHours()},o.getMinutes=function(){return o.date.getMinutes()},o.getSeconds=function(){return o.date.getSeconds()},o.getMilliseconds=function(){return o.date.getMilliseconds()},o.getTimezoneOffset=function(){return 60*e},o.getUTCFullYear=function(){return o.origDate.getUTCFullYear()},o.getUTCMonth=function(){return o.origDate.getUTCMonth()},o.getUTCDate=function(){return o.origDate.getUTCDate()},o.getUTCHours=function(){return o.origDate.getUTCHours()},o.getUTCMinutes=function(){return o.origDate.getUTCMinutes()},o.getUTCSeconds=function(){return o.origDate.getUTCSeconds()},o.getUTCMilliseconds=function(){return o.origDate.getUTCMilliseconds()},o.getDay=function(){return o.date.getDay()},o.toISOString&&(o.toISOString=function(){return i(o.origDate.getUTCFullYear(),4)+"-"+i(o.origDate.getUTCMonth()+1,2)+"-"+i(o.origDate.getUTCDate(),2)+"T"+i(o.origDate.getUTCHours(),2)+":"+i(o.origDate.getUTCMinutes(),2)+":"+i(o.origDate.getUTCSeconds(),2)+"."+i(o.origDate.getUTCMilliseconds(),3)+"Z"});var s=["getUTCDay","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toGMTString","toJSON","toLocaleFormat","toLocaleString","toLocaleTimeString","toSource","toString","toTimeString","toUTCString","valueOf"];return t.forEach(s,function(e){o[e]=function(){throw new Error("Method '"+e+"' is not implemented in the TzDate mock")}}),o},t.mock.TzDate.prototype=Date.prototype,t.mock.animate=t.module("ngAnimateMock",["ng"]).config(["$provide",function(e){e.factory("$$forceReflow",function(){function e(){e.totalReflows++}return e.totalReflows=0,e}),e.factory("$$animateAsyncRun",function(){var e=[],t=function(){return function(t){e.push(t)}};return t.flush=function(){if(0===e.length)return!1;for(var t=0;t<e.length;t++)e[t]();return e=[],!0},t}),e.decorator("$$animateJs",["$delegate",function(e){var t=[],n=function(){var n=e.apply(e,arguments);return n&&t.push(n),n};return n.$closeAndFlush=function(){t.forEach(function(e){e.end()}),t=[]},n}]),e.decorator("$animateCss",["$delegate",function(e){var t=[],n=function(n,r){var o=e(n,r);return t.push(o),o};return n.$closeAndFlush=function(){t.forEach(function(e){e.end()}),t=[]},n}]),e.decorator("$animate",["$delegate","$timeout","$browser","$$rAF","$animateCss","$$animateJs","$$forceReflow","$$animateAsyncRun","$rootScope",function(e,n,r,o,i,a,c,s,u){var l={queue:[],cancel:e.cancel,on:e.on,off:e.off,pin:e.pin,get reflows(){return c.totalReflows},enabled:e.enabled,closeAndFlush:function(){this.flush(!0),i.$closeAndFlush(),a.$closeAndFlush(),this.flush()},flush:function(e){u.$digest();var t,n=!1;do t=!1,o.queue.length&&(o.flush(),t=n=!0),s.flush()&&(t=n=!0);while(t);if(!n&&!e)throw new Error("No pending animations ready to be closed or flushed");u.$digest()}};return t.forEach(["animate","enter","leave","move","addClass","removeClass","setClass"],function(t){l[t]=function(){return l.queue.push({event:t,element:arguments[0],options:arguments[arguments.length-1],args:arguments}),e[t].apply(e,arguments)}}),l}])}]),t.mock.dump=function(e){function n(e){var o;return t.isElement(e)?(e=t.element(e),o=t.element("<div></div>"),t.forEach(e,function(e){o.append(t.element(e).clone())}),o=o.html()):t.isArray(e)?(o=[],t.forEach(e,function(e){o.push(n(e))}),o="[ "+o.join(", ")+" ]"):o=t.isObject(e)?t.isFunction(e.$eval)&&t.isFunction(e.$apply)?r(e):e instanceof Error?e.stack||""+e.name+": "+e.message:t.toJson(e,!0):String(e),o}function r(e,n){n=n||"  ";var o=[n+"Scope("+e.$id+"): {"];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&!i.match(/^(\$|this)/)&&o.push("  "+i+": "+t.toJson(e[i]));for(var a=e.$$childHead;a;)o.push(r(a,n+"  ")),a=a.$$nextSibling;return o.push("}"),o.join("\n"+n)}return n(e)},t.mock.$HttpBackendProvider=function(){this.$get=["$rootScope","$timeout",a]},t.mock.$TimeoutDecorator=["$delegate","$browser",function(e,n){function r(e){var n=[];return t.forEach(e,function(e){n.push("{id: "+e.id+", time: "+e.time+"}")}),n.join(", ")}return e.flush=function(e){n.defer.flush(e)},e.verifyNoPendingTasks=function(){if(n.deferredFns.length)throw new Error("Deferred tasks to flush ("+n.deferredFns.length+"): "+r(n.deferredFns))},e}],t.mock.$RAFDecorator=["$delegate",function(e){var t=function(e){var n=t.queue.length;return t.queue.push(e),function(){t.queue.splice(n,1)}};return t.queue=[],t.supported=e.supported,t.flush=function(){if(0===t.queue.length)throw new Error("No rAF callbacks present");for(var e=t.queue.length,n=0;e>n;n++)t.queue[n]();t.queue=t.queue.slice(n)},t}];var l;t.mock.$RootElementProvider=function(){this.$get=["$injector",function(e){return l=t.element("<div ng-app></div>").data("$injector",e)}]},t.mock.$ControllerDecorator=["$delegate",function(e){return function(n,r,o,i){if(o&&"object"==typeof o){var a=e(n,r,!0,i);return t.extend(a.instance,o),a()}return e(n,r,o,i)}}],t.mock.$ComponentControllerProvider=["$compileProvider",function(e){this.$get=["$controller","$injector",function(e,t){return function(n,r,o,i){var a=t.get(n+"Directive"),c=a.filter(function(e){return e.controller&&e.controllerAs&&"E"===e.restrict});if(0===c.length)throw new Error("No component found");if(c.length>1)throw new Error("Too many components found");var s=c[0];return e(s.controller,r,o,i||s.controllerAs)}}]}],t.module("ngMock",["ng"]).provider({$browser:t.mock.$BrowserProvider,$exceptionHandler:t.mock.$ExceptionHandlerProvider,$log:t.mock.$LogProvider,$interval:t.mock.$IntervalProvider,$httpBackend:t.mock.$HttpBackendProvider,$rootElement:t.mock.$RootElementProvider,$componentController:t.mock.$ComponentControllerProvider}).config(["$provide",function(e){e.decorator("$timeout",t.mock.$TimeoutDecorator),e.decorator("$$rAF",t.mock.$RAFDecorator),e.decorator("$rootScope",t.mock.$RootScopeDecorator),e.decorator("$controller",t.mock.$ControllerDecorator)}]),t.module("ngMockE2E",["ng"]).config(["$provide",function(e){e.decorator("$httpBackend",t.mock.e2e.$httpBackendDecorator)}]),t.mock.e2e={},t.mock.e2e.$httpBackendDecorator=["$rootScope","$timeout","$delegate","$browser",a],t.mock.$RootScopeDecorator=["$delegate",function(e){function t(){for(var e,t=0,n=[this.$$childHead];n.length;)for(e=n.shift();e;)t+=1,n.push(e.$$childHead),e=e.$$nextSibling;return t}function n(){for(var e,t=this.$$watchers?this.$$watchers.length:0,n=[this.$$childHead];n.length;)for(e=n.shift();e;)t+=e.$$watchers?e.$$watchers.length:0,n.push(e.$$childHead),e=e.$$nextSibling;return t}var r=Object.getPrototypeOf(e);return r.$countChildScopes=t,r.$countWatchers=n,e}],!function(r){function o(){this.shared=!1,this.sharedError=null,this.cleanupAfterEach=function(){return!this.shared||this.sharedError}}if(r){var i=null,a=new o,c=[],u=function(){return!!i};t.mock.$$annotate=t.injector.$$annotate,t.injector.$$annotate=function(e){return"function"!=typeof e||e.$inject||c.push(e),t.mock.$$annotate.apply(this,arguments)};var d=e.module=t.mock.module=function(){function e(){if(i.$injector)throw new Error("Injector already created, can not register a module!");var e,r=i.$modules||(i.$modules=[]);t.forEach(n,function(n){e=t.isObject(n)&&!t.isArray(n)?["$provide",function(e){t.forEach(n,function(t,n){e.value(n,t)})}]:n,i.$providerInjector?i.$providerInjector.invoke(e):r.push(e)})}var n=Array.prototype.slice.call(arguments,0);return u()?e():e};d.$$beforeAllHook=e.before||e.beforeAll,d.$$afterAllHook=e.after||e.afterAll,d.$$currentSpec=function(e){return 0===arguments.length?e:void(i=e)},d.sharedInjector=function(){if(!d.$$beforeAllHook||!d.$$afterAllHook)throw Error("sharedInjector() cannot be used unless your test runner defines beforeAll/afterAll");var e=!1;d.$$beforeAllHook(function(){if(a.shared)throw a.sharedError=Error("sharedInjector() cannot be called inside a context that has already called sharedInjector()"),a.sharedError;e=!0,i=this,a.shared=!0}),d.$$afterAllHook(function(){e?(a=new o,d.$$cleanup()):a.sharedError=null})},d.$$beforeEach=function(){if(a.shared&&i&&i!=this){var e=i;i=this,t.forEach(["$injector","$modules","$providerInjector","$injectorStrict"],function(t){i[t]=e[t],e[t]=null})}else i=this,l=null,c=[]},d.$$afterEach=function(){a.cleanupAfterEach()&&d.$$cleanup()},d.$$cleanup=function(){var e=i.$injector;if(c.forEach(function(e){delete e.$inject}),t.forEach(i.$modules,function(e){e&&e.$$hashKey&&(e.$$hashKey=n)}),i.$injector=null,i.$modules=null,i.$providerInjector=null,i=null,e){var r=e.get("$rootElement"),o=r&&r[0],a=l?[l[0]]:[];!o||l&&o===l[0]||a.push(o),t.element.cleanData(a);var u=e.get("$rootScope");u&&u.$destroy&&u.$destroy()}t.forEach(t.element.fragments,function(e,n){delete t.element.fragments[n]}),s.$$lastInstance=null,t.forEach(t.callbacks,function(e,n){delete t.callbacks[n]}),t.callbacks.counter=0},(e.beforeEach||e.setup)(d.$$beforeEach),(e.afterEach||e.teardown)(d.$$afterEach);var f=function(e,t){this.message=e.message,this.name=e.name,e.line&&(this.line=e.line),e.sourceId&&(this.sourceId=e.sourceId),e.stack&&t&&(this.stack=e.stack+"\n"+t.stack),e.stackArray&&(this.stackArray=e.stackArray)};f.prototype.toString=Error.prototype.toString,e.inject=t.mock.inject=function(){function e(){var e=i.$modules||[],o=!!i.$injectorStrict;e.unshift(["$injector",function(e){i.$providerInjector=e}]),e.unshift("ngMock"),e.unshift("ng");var a=i.$injector;a||(o&&t.forEach(e,function(e){"function"==typeof e&&t.injector.$$annotate(e)}),a=i.$injector=t.injector(e,o),i.$injectorStrict=o);for(var c=0,s=n.length;s>c;c++){i.$injectorStrict&&a.annotate(n[c]);try{a.invoke(n[c]||t.noop,this)}catch(u){if(u.stack&&r)throw new f(u,r);throw u}finally{r=null}}}var n=Array.prototype.slice.call(arguments,0),r=new Error("Declaration Location");
return u()?e.call(i):e},t.mock.inject.strictDi=function(e){function t(){if(e!==i.$injectorStrict){if(i.$injector)throw new Error("Injector already created, can not modify strict annotations");i.$injectorStrict=e}}return e=arguments.length?!!e:!0,u()?t():t}}}(e.jasmine||e.mocha)}(window,window.angular);